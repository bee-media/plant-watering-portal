-- Файл с примерами растений для быстрого старта
-- Выполните этот файл ПОСЛЕ создания базы данных и первого пользователя
-- mysql -u root -p plant_watering < sample_plants.sql

USE plant_watering;

-- Вставка примеров растений
INSERT INTO plants (name, watering_interval_days, fertilizer_interval_days, description, location) VALUES
('Фикус Бенджамина', 7, 30, 'Популярное комнатное растение с красивыми листьями. Не любит переувлажнения.', 'Гостиная, у окна'),
('Алоэ Вера', 14, 60, 'Суккулент, не требует частого полива. Полезен для кожи.', 'Кухня, подоконник'),
('Монстера деликатесная', 5, 21, 'Крупное тропическое растение с резными листьями. Любит влажность.', 'Спальня'),
('Сансевиерия (Щучий хвост)', 10, 90, 'Неприхотливое растение, очищает воздух. Растет в любых условиях.', 'Коридор'),
('Спатифиллум (Женское счастье)', 3, 14, 'Цветущее растение, требует регулярного полива. Не любит прямых солнечных лучей.', 'Ванная комната'),
('Замиокулькас', 14, 60, 'Суккулент с глянцевыми листьями. Хорошо переносит засуху.', 'Кабинет'),
('Хлорофитум', 5, 30, 'Очищает воздух, неприхотлив. Быстро растет.', 'Детская комната'),
('Драцена', 7, 30, 'Пальмовидное растение. Нуждается в умеренном поливе.', 'Гостиная'),
('Папоротник', 2, 14, 'Любит влажность и полутень. Требует частого полива.', 'Ванная комната'),
('Кактус', 21, NULL, 'Суккулент, не требует частого полива. Любит солнце.', 'Балкон');

-- Вставка истории поливов (для демонстрации)
-- Замените user_id на ID вашего пользователя
INSERT INTO watering_history (plant_id, user_id, action_type, notes) VALUES
(1, 1, 'watering', 'Регулярный полив'),
(2, 1, 'watering', 'Полив после долгого отсутствия'),
(3, 1, 'watering', NULL),
(3, 1, 'fertilizer', 'Добавлены минеральные удобрения'),
(4, 1, 'watering', 'Листья стали желтеть, уменьшил полив'),
(5, 1, 'watering', NULL),
(1, 1, 'fertilizer', 'Комплексное удобрение для фикусов');

-- Обновление дат следующего полива для всех растений
UPDATE plants p
SET 
    last_watered_at = DATE_SUB(NOW(), INTERVAL p.watering_interval_days DAY),
    next_watering_date = CURDATE(),
    last_fertilized_at = CASE 
        WHEN p.fertilizer_interval_days IS NOT NULL 
        THEN DATE_SUB(NOW(), INTERVAL p.fertilizer_interval_days DAY)
        ELSE NULL 
    END,
    next_fertilizer_date = CASE 
        WHEN p.fertilizer_interval_days IS NOT NULL 
        THEN CURDATE()
        ELSE NULL 
    END
WHERE is_active = TRUE;

-- Информационное сообщение
SELECT 'Примеры растений успешно добавлены!' as Message;
SELECT COUNT(*) as 'Всего растений' FROM plants WHERE is_active = TRUE;
