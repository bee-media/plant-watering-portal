{% extends "base.html" %}

{% block title %}{% if action == 'add' %}Добавить растение{% else %}Редактировать растение{% endif %}{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>
            <i class="fas fa-{% if action == 'add' %}plus{% else %}edit{% endif %}"></i>
            {% if action == 'add' %}Добавить новое растение{% else %}Редактировать растение{% endif %}
        </h1>
    </div>

    <div class="form-container">
        <form method="POST" enctype="multipart/form-data" class="plant-form">
            <div class="form-grid">
                <div class="form-section">
                    <h3><i class="fas fa-info-circle"></i> Основная информация</h3>
                    
                    <div class="form-group">
                        <label for="name">
                            <i class="fas fa-seedling"></i> Название растения *
                        </label>
                        <input type="text" id="name" name="name" 
                               value="{% if action == 'edit' %}{{ plant.name }}{% endif %}" 
                               required autofocus
                               placeholder="Например: Фикус Бенджамина">
                    </div>

                    <div class="form-group">
                        <label for="location">
                            <i class="fas fa-map-marker-alt"></i> Местоположение
                        </label>
                        <input type="text" id="location" name="location" 
                               value="{% if action == 'edit' %}{{ plant.location }}{% endif %}"
                               placeholder="Например: Гостиная, подоконник">
                    </div>

                    <div class="form-group">
                        <label for="description">
                            <i class="fas fa-align-left"></i> Описание
                        </label>
                        <textarea id="description" name="description" 
                                  placeholder="Добавьте заметки о растении...">{% if action == 'edit' %}{{ plant.description }}{% endif %}</textarea>
                    </div>

                    <div class="form-group">
                        <label for="image">
                            <i class="fas fa-image"></i> Фотография растения
                        </label>
                        {% if action == 'edit' and plant.image_url %}
                        <div class="current-image">
                            <img src="{{ plant.image_url }}" alt="{{ plant.name }}">
                            <p>Текущее изображение</p>
                        </div>
                        {% endif %}
                        <input type="file" id="image" name="image" accept="image/*">
                        <small>Форматы: PNG, JPG, JPEG, GIF, WEBP (максимум 16 МБ)</small>
                    </div>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-calendar-alt"></i> Расписание ухода</h3>
                    
                    <div class="form-group">
                        <label for="watering_interval">
                            <i class="fas fa-droplet"></i> Интервал полива (дни) *
                        </label>
                        <input type="number" id="watering_interval" name="watering_interval" 
                               value="{% if action == 'edit' %}{{ plant.watering_interval_days }}{% endif %}" 
                               min="1" required
                               placeholder="Например: 7">
                        <small>Как часто нужно поливать это растение</small>
                    </div>

                    <div class="form-group">
                        <label for="fertilizer_interval">
                            <i class="fas fa-flask"></i> Интервал прикормки (дни)
                        </label>
                        <input type="number" id="fertilizer_interval" name="fertilizer_interval" 
                               value="{% if action == 'edit' %}{{ plant.fertilizer_interval_days }}{% endif %}" 
                               min="1"
                               placeholder="Например: 30">
                        <small>Как часто нужно прикармливать (оставьте пустым, если не требуется)</small>
                    </div>

                    <div class="info-box">
                        <i class="fas fa-lightbulb"></i>
                        <div>
                            <strong>Совет:</strong>
                            <p>После добавления растения система автоматически начнет отслеживать расписание 
                               и отправлять уведомления в Telegram.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <a href="{{ url_for('plants_list') }}" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Отмена
                </a>
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-{% if action == 'add' %}plus{% else %}save{% endif %}"></i> 
                    {% if action == 'add' %}Добавить растение{% else %}Сохранить изменения{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>

<style>
.form-container {
    max-width: 1200px;
    margin: 0 auto;
    background: var(--card-bg);
    border-radius: 16px;
    padding: 2.5rem;
    box-shadow: var(--shadow);
}

.plant-form {
    width: 100%;
}

.form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    margin-bottom: 2rem;
}

.form-section {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.form-section h3 {
    color: var(--primary-dark);
    font-size: 1.25rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid var(--border-color);
}

.form-group small {
    display: block;
    margin-top: 0.5rem;
    color: var(--text-secondary);
    font-size: 0.875rem;
}

.current-image {
    margin-bottom: 1rem;
    text-align: center;
}

.current-image img {
    max-width: 200px;
    max-height: 200px;
    border-radius: 12px;
    box-shadow: var(--shadow);
    margin-bottom: 0.5rem;
}

.current-image p {
    color: var(--text-secondary);
    font-size: 0.875rem;
}

.info-box {
    padding: 1.25rem;
    background: linear-gradient(135deg, rgba(45, 106, 79, 0.05), rgba(116, 198, 157, 0.05));
    border-left: 4px solid var(--primary-color);
    border-radius: 8px;
    display: flex;
    gap: 1rem;
}

.info-box i {
    font-size: 1.5rem;
    color: var(--primary-color);
    flex-shrink: 0;
}

.info-box strong {
    color: var(--primary-dark);
    display: block;
    margin-bottom: 0.25rem;
}

.info-box p {
    color: var(--text-secondary);
    font-size: 0.95rem;
    margin: 0;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
    padding-top: 1.5rem;
    border-top: 2px solid var(--border-color);
}

@media (max-width: 768px) {
    .form-grid {
        grid-template-columns: 1fr;
    }

    .form-container {
        padding: 1.5rem;
    }

    .form-actions {
        flex-direction: column-reverse;
    }

    .form-actions .btn {
        width: 100%;
    }
}
</style>
{% endblock %}
